<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>üòõ ‡§∏‡§æ‡§≤‡•Ä ‡§®‡•á ‡§ú‡•Ä‡§ú‡§æ ‡§ï‡§æ ‡§≤‡§Ç‡§° ‡§ö‡•Ç‡§∏‡§æ üçë ‡§™‡•Ç‡§∞‡§æ ‡§®‡§ø‡§ó‡§≤ ‡§≤‡§ø‡§Ø‡§æ | Clipfy Player</title>

<meta name="twitter:card" content="summary_large_image" /> 
<meta name="twitter:title" content="üòõ ‡§∏‡§æ‡§≤‡•Ä ‡§®‡•á ‡§ú‡•Ä‡§ú‡§æ ‡§ï‡§æ ‡§≤‡§Ç‡§° ‡§ö‡•Ç‡§∏‡§æ üçë ‡§™‡•Ç‡§∞‡§æ ‡§®‡§ø‡§ó‡§≤ ‡§≤‡§ø‡§Ø‡§æ" />
<meta name="twitter:description" content="" />
<meta name="twitter:image" content="https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/d8d9c550720f4034bc62772fd8096d4e.jpg" />
<meta property="og:image" content="https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/d8d9c550720f4034bc62772fd8096d4e.jpg" />
<meta property="og:image:width" content="1280" />
<meta property="og:image:height" content="720" />

<meta name="twitter:player" content="https://clipfy.store/v/d8d9c550720f4034bc62772fd8096d4e.html" />
<meta name="twitter:player:width" content="720" />
<meta name="twitter:player:height" content="405" />
<meta name="twitter:player:stream" content="https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/videos/d8d9c550720f4034bc62772fd8096d4e.mp4" />
<meta name="twitter:player:stream:content_type" content="video/mp4" />



  
<style>


  
/* ---------------- Styles (clean + minimal changes) ---------------- */

body{
  background:#0f141a;
  color:#fff;
  font-family:Arial, sans-serif;
  margin:0;
  padding:0;
  overflow-x:hidden;
}

/* ---------------- Fixed Video Box ---------------- */
.video-box{
  width:100%;
  height:40vh;
  position:fixed;
  top:0;
  left:0;
  background:#000;
  overflow:hidden;
  z-index:9999;
  display:flex;
  align-items:center;
  justify-content:center;
}
video{
  width:100%;
  height:100%;
  object-fit:contain;
}

/* ---------------- Scrollable Content ---------------- */
.content-wrapper{
  padding-top:40vh;
  min-height:250vh;
}

/* ---------------- Top Slim Ad ---------------- */
.top-slim-ad{
  background:#1a2430;
  padding:6px 0;
  margin:0;
  text-align:center;
  border-bottom:1px solid #222;
}

/* ---------------- Header / Post / Stats ---------------- */
.header{
  display:flex;
  justify-content:space-between;
  padding:12px;
  border-bottom:1px solid #222;
  font-size:20px;
}
.post{
  padding:12px;
  display:flex;
  gap:10px;
  align-items:center;
}
.dp{
  width:42px;
  height:42px;
  border-radius:50%;
  background:#555;
}
.stats{
  display:flex;
  gap:15px;
  padding:12px;
  border-bottom:1px solid #222;
  font-size:14px;
  align-items:center;
}
.blog-content{
  padding:20px;
  font-size:17px;
  line-height:1.7;
}

/* ---------------- Suggestions Section ---------------- */
.suggestions-header{
  padding:12px 20px;
  font-size:18px;
  font-weight:700;
  border-top:1px solid #222;
}
.video-suggestions-list{
  background:transparent;
  overflow:visible;
}

/* Fix thumbnail cropping 100% */
.suggestion-thumbnail img{
  width:100%;
  height:100%;
  object-fit:cover;
  display:block;
}

/* ---------------- Full-width suggestion cards ---------------- */
.suggestion-item{
  display:block;
  width:100%;
  padding:14px 20px;
  cursor:pointer;
  border-bottom:1px solid #1a2430;
  transition:background .12s;
  overflow:visible;
  height:auto;
}
.suggestion-item:hover{
  background:#0b1216;
}

/* Thumbnail box */
.suggestion-thumbnail{
  width:100%;
  aspect-ratio:16/9;
  background:#333;
  border-radius:6px;
  overflow:hidden;
  margin-bottom:10px;
}

/* Text content */
.suggestion-details{
  display:flex;
  flex-direction:column;
  justify-content:center;
}
.suggestion-title{
  font-weight:600;
  font-size:16px;
  display:-webkit-box;
  -webkit-line-clamp:2;
  -webkit-box-orient:vertical;
  overflow:hidden;
}
.suggestion-creator{
  font-size:12px;
  color:#aaa;
  margin-top:4px;
}

/* ---------------- Ad Slot ---------------- */
.suggested-ad-slot{
  display:flex;
  justify-content:center;
  padding:15px 0;
  border-bottom:1px solid #222;
  background:transparent;
}

/* ---------------- Utilities ---------------- */
.center{
  text-align:center;
}
.hidden{
  display:none !important;
}

  
  
</style>
</head>

<body>

<div class="video-box">
  <video id="player" playsinline controls autoplay muted>
    <source src="https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/videos/d8d9c550720f4034bc62772fd8096d4e.mp4" type="video/mp4">
  </video>
</div>

<div class="content-wrapper">


  <div class="header">
    <div>X</div>
    <div>‚ãØ</div>
  </div>

  <div class="post">
    <div class="dp" id="creatorDp"></div>
    <div>
      <div style="font-weight:300;" id="creatorName">Clipfy video</div>
      <div class="title" id="timeAgo">just now</div>
    </div>
  </div>

  <div class="stats">
    <span id="likes">0</span> <span id="views">0</span>
    <div style="margin-left:auto; cursor:pointer;" id="shareBtn">üîó Share</div>
  </div>

  <div class="top-slim-ad" id="topSlimAd" aria-hidden="true">
    <div id="topSlimAdInner" style="width:728px; max-width:95%; height:90px; margin:0 auto;"></div>
  </div>



  <div class="blog-content">
    <h2 id="mainTitle">üòõ ‡§∏‡§æ‡§≤‡•Ä ‡§®‡•á ‡§ú‡•Ä‡§ú‡§æ ‡§ï‡§æ ‡§≤‡§Ç‡§° ‡§ö‡•Ç‡§∏‡§æ üçë ‡§™‡•Ç‡§∞‡§æ ‡§®‡§ø‡§ó‡§≤ ‡§≤‡§ø‡§Ø‡§æ</h2>
  </div>





  <div class="suggestions-header">More Viral Videos üî•</div>
  <div class="video-suggestions-list" id="videoSuggestionsList"></div>

  <div id="nativeAd" style="padding:20px 0; text-align:center;"></div>
  </div>

<script>
/* ----------------- Config (templated server-side) ----------------- */
let VIDEO_ID = 'd8d9c550720f4034bc62772fd8096d4e';
const API_BASE = '{{API_BASE}}';
const ALL_VIDEOS = [{"title": "\ud83d\udc40 Wife cheating neighbor caught on cam \ud83d\udd25", "creator": "Content Creator", "video_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/videos/44de8614d0fa4553b07dd7884aef241f.mp4", "thumb_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/44de8614d0fa4553b07dd7884aef241f.jpg", "video_id": "44de8614d0fa4553b07dd7884aef241f", "time_ago": "just now", "description": "", "player_page_url": "https://clipfy.store/v/44de8614d0fa4553b07dd7884aef241f.html", "player_page_safe_url": "https://clipfy.store/v/44de8614d0fa4553b07dd7884aef241f_safe.html", "thumb_blur_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/44de8614d0fa4553b07dd7884aef241f_blur.jpg"}, {"title": "\ud83c\udfe8 Padosan randi ko zabardasti fuck kiya \ud83d\ude31 hotel me", "creator": "Content Creator", "video_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/videos/f42274b19a564e67ad9d2d7b8af7d40a.mp4", "thumb_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/f42274b19a564e67ad9d2d7b8af7d40a.jpg", "video_id": "f42274b19a564e67ad9d2d7b8af7d40a", "time_ago": "just now", "description": "", "player_page_url": "https://clipfy.store/v/f42274b19a564e67ad9d2d7b8af7d40a.html", "player_page_safe_url": "https://clipfy.store/v/f42274b19a564e67ad9d2d7b8af7d40a_safe.html", "thumb_blur_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/f42274b19a564e67ad9d2d7b8af7d40a_blur.jpg"}, {"title": "\ud83d\udca5 Bhabhi ki gaand phaar diya 10 inch se \ud83d\udca6", "creator": "Content Creator", "video_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/videos/bb70dba2353b46b7a2a1bcc117c78099.mp4", "thumb_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/bb70dba2353b46b7a2a1bcc117c78099.jpg", "video_id": "bb70dba2353b46b7a2a1bcc117c78099", "time_ago": "just now", "description": "", "player_page_url": "https://clipfy.store/v/bb70dba2353b46b7a2a1bcc117c78099.html", "player_page_safe_url": "https://clipfy.store/v/bb70dba2353b46b7a2a1bcc117c78099_safe.html", "thumb_blur_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/bb70dba2353b46b7a2a1bcc117c78099_blur.jpg"}, {"title": "\ud83d\udcf9 \u092e\u092e\u094d\u092e\u0940 \u0915\u0940 \u0917\u093e\u0902\u0921\u093c \u092e\u093e\u0930\u0924\u0947 \u0939\u0941\u090f \u0935\u0940\u0921\u093f\u092f\u094b \u0932\u0940\u0915 \ud83d\udd25", "creator": "Content Creator", "video_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/videos/70d69c4e9fec455098e032a9fd3de470.mp4", "thumb_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/70d69c4e9fec455098e032a9fd3de470.jpg", "video_id": "70d69c4e9fec455098e032a9fd3de470", "time_ago": "just now", "description": "", "player_page_url": "https://clipfy.store/v/70d69c4e9fec455098e032a9fd3de470.html", "player_page_safe_url": "https://clipfy.store/v/70d69c4e9fec455098e032a9fd3de470_safe.html", "thumb_blur_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/70d69c4e9fec455098e032a9fd3de470_blur.jpg"}, {"title": "\ud83d\ude34 \u0932\u0921\u093c\u0915\u0940 \u092c\u0947\u0939\u094b\u0936 \u0939\u094b \u0917\u0908 \u092e\u094b\u091f\u0940 \u091a\u0941\u0926\u093e\u0908 \u0938\u0947 \ud83d\udca6", "creator": "Content Creator", "video_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/videos/bef37b4543824cb8997eba87e4d346ab.mp4", "thumb_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/bef37b4543824cb8997eba87e4d346ab.jpg", "video_id": "bef37b4543824cb8997eba87e4d346ab", "time_ago": "just now", "description": "", "player_page_url": "https://clipfy.store/v/bef37b4543824cb8997eba87e4d346ab.html", "player_page_safe_url": "https://clipfy.store/v/bef37b4543824cb8997eba87e4d346ab_safe.html", "thumb_blur_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/bef37b4543824cb8997eba87e4d346ab_blur.jpg"}, {"title": "\ud83c\udfe2 \u0911\u092b\u093f\u0938 \u0917\u0930\u094d\u0932 \u0915\u094b \u092c\u0949\u0938 \u0928\u0947 \u0932\u093f\u092b\u094d\u091f \u092e\u0947\u0902 \u091a\u094b\u0926\u093e \ud83c\udf46", "creator": "Content Creator", "video_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/videos/e5ddddd27e8f45a99c18584e52cac7ed.mp4", "thumb_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/e5ddddd27e8f45a99c18584e52cac7ed.jpg", "video_id": "e5ddddd27e8f45a99c18584e52cac7ed", "time_ago": "just now", "description": "", "player_page_url": "https://clipfy.store/v/e5ddddd27e8f45a99c18584e52cac7ed.html", "player_page_safe_url": "https://clipfy.store/v/e5ddddd27e8f45a99c18584e52cac7ed_safe.html", "thumb_blur_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/e5ddddd27e8f45a99c18584e52cac7ed_blur.jpg"}, {"title": "\ud83c\udf46 Didi bhai ke lund pe ride nonstop \ud83d\udca6", "creator": "Content Creator", "video_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/videos/3e3be73824894bd28e5d7916990de7f8.mp4", "thumb_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/3e3be73824894bd28e5d7916990de7f8.jpg", "video_id": "3e3be73824894bd28e5d7916990de7f8", "time_ago": "just now", "description": "", "player_page_url": "https://clipfy.store/v/3e3be73824894bd28e5d7916990de7f8.html", "player_page_safe_url": "https://clipfy.store/v/3e3be73824894bd28e5d7916990de7f8_safe.html", "thumb_blur_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/3e3be73824894bd28e5d7916990de7f8_blur.jpg"}, {"title": "\ud83d\ude34 \u0932\u0921\u093c\u0915\u0940 \u092c\u0947\u0939\u094b\u0936 \u0939\u094b \u0917\u0908 \u092e\u094b\u091f\u0940 \u091a\u0941\u0926\u093e\u0908 \u0938\u0947 \ud83d\udca6", "creator": "Content Creator", "video_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/videos/f8c31667cf4b4b429400778b56de9b22.mp4", "thumb_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/f8c31667cf4b4b429400778b56de9b22.jpg", "video_id": "f8c31667cf4b4b429400778b56de9b22", "time_ago": "just now", "description": "", "player_page_url": "https://clipfy.store/v/f8c31667cf4b4b429400778b56de9b22.html", "player_page_safe_url": "https://clipfy.store/v/f8c31667cf4b4b429400778b56de9b22_safe.html", "thumb_blur_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/f8c31667cf4b4b429400778b56de9b22_blur.jpg"}, {"title": "\ud83d\ude97 \u0938\u094d\u0915\u0942\u0932 \u091f\u0940\u091a\u0930 \u0938\u094d\u091f\u0942\u0921\u0947\u0902\u091f \u0915\u0947 \u0938\u093e\u0925 \u0915\u093e\u0930 \u091a\u0941\u0926\u093e\u0908 \ud83d\udd25", "creator": "Content Creator", "video_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/videos/ad437ad05f064f928e310e374ac32858.mp4", "thumb_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/ad437ad05f064f928e310e374ac32858.jpg", "video_id": "ad437ad05f064f928e310e374ac32858", "time_ago": "just now", "description": "", "player_page_url": "https://clipfy.store/v/ad437ad05f064f928e310e374ac32858.html", "player_page_safe_url": "https://clipfy.store/v/ad437ad05f064f928e310e374ac32858_safe.html", "thumb_blur_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/ad437ad05f064f928e310e374ac32858_blur.jpg"}, {"title": "\ud83d\udc94 \u092a\u0924\u094d\u0928\u0940 \u0915\u094b \u0926\u094b\u0938\u094d\u0924 \u0928\u0947 \u091a\u094b\u0926\u093e \ud83c\udf46 \u092a\u0924\u093f \u0926\u0947\u0916\u0924\u093e \u0930\u0939\u093e", "creator": "Content Creator", "video_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/videos/095bde8953fc47cd8a3c207be5cc47b1.mp4", "thumb_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/095bde8953fc47cd8a3c207be5cc47b1.jpg", "video_id": "095bde8953fc47cd8a3c207be5cc47b1", "time_ago": "just now", "description": "", "player_page_url": "https://clipfy.store/v/095bde8953fc47cd8a3c207be5cc47b1.html", "player_page_safe_url": "https://clipfy.store/v/095bde8953fc47cd8a3c207be5cc47b1_safe.html", "thumb_blur_url": "https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/095bde8953fc47cd8a3c207be5cc47b1_blur.jpg"}]; // Array of video objects: {video_id, video_url, thumb_url, title, creator, time_ago, likes, views, description, player_page_url, thumb}
ALL_VIDEOS.sort(() => Math.random() - 0.5);  // Randomize suggestion order per page load
const INITIAL_DATA = {
  title: 'üòõ ‡§∏‡§æ‡§≤‡•Ä ‡§®‡•á ‡§ú‡•Ä‡§ú‡§æ ‡§ï‡§æ ‡§≤‡§Ç‡§° ‡§ö‡•Ç‡§∏‡§æ üçë ‡§™‡•Ç‡§∞‡§æ ‡§®‡§ø‡§ó‡§≤ ‡§≤‡§ø‡§Ø‡§æ',
  thumb: 'https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/d8d9c550720f4034bc62772fd8096d4e.jpg',
  description: ''
};
/* ----------------------------------------------------------------- */

/* DOM refs */
const player = document.getElementById('player');
const likesEl = document.getElementById('likes');
const viewsEl = document.getElementById('views');
const timeAgoEl = document.getElementById('timeAgo');
const mainTitleEl = document.getElementById('mainTitle');
const videoSuggestionsList = document.getElementById('videoSuggestionsList');
const shareBtn = document.getElementById('shareBtn');
const creatorNameEl = document.getElementById('creatorName');
const creatorDpEl = document.getElementById('creatorDp');

/* View counting */
let viewCounted = false;
player.addEventListener('play', ()=>{
  if (!viewCounted && VIDEO_ID){
    viewCounted = true;
    // fire view hit
    try{
      fetch(`${API_BASE}/hit`, {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({video_id: VIDEO_ID, type:'view'})
      }).catch(()=>{/* ignore network errors silently */});
    }catch(e){}
  }
});

/* Share button */
shareBtn.onclick = ()=>{
  const shareTitle = document.querySelector('meta[name="twitter:title"]').getAttribute('content') || document.title;
  if (navigator.share){
    navigator.share({ title: shareTitle, url: location.href }).catch(()=>{/* ignore */});
  } else {
    navigator.clipboard?.writeText(location.href).then(()=>alert('Link Copied!')).catch(()=>alert(location.href));
  }
};

/* ----------------- Ad injection utility (Updated) ----------------- */
/*
  injectAtOptionsAd: injects atOptions and vendor script for iframe ad
  key: ad key string (from your atOptions)
  container: DOM element where ad script should render
  width, height: numbers (ad frame size)
*/
function injectAtOptionsAd(key, container, width, height){
  if(!container) return;
  // prevent duplicate by data attribute
  const marker = `data-atoptions-${key}-${width}x${height}`;
  if (container.getAttribute(marker)) return;
  container.setAttribute(marker, '1');

  // 1) inline script to set atOptions
  const inline = document.createElement('script');
  inline.type = 'text/javascript';
  inline.text = `atOptions = {'key':'${key}','format':'iframe','height':${height},'width':${width},'params':{}};`;
  container.appendChild(inline);

  // 2) vendor script (same domain used in original)
  const src = "//www.highperformanceformat.com/" + key + "/invoke.js";
  const s = document.createElement('script');
  s.type = 'text/javascript';
  s.async = true;
  s.src = src;
  container.appendChild(s);
}

/*
  injectNativeBannerAd: injects the Adsterra Native Banner script
  container: DOM element where ad script should render
*/
function injectNativeBannerAd(container){
  if(!container) return;
  // Use a unique marker for this specific ad unit
  const marker = `data-adsterra-native`;
  if (container.getAttribute(marker)) return;
  container.setAttribute(marker, '1');

  // 1) Async script 
  const s1 = document.createElement('script');
  s1.type = 'text/javascript';
  s1.async = true;
  s1.setAttribute('data-cfasync', 'false');
  // Use your Native Banner source
  s1.src = "//pl28119894.effectivegatecpm.com/2095e01c6ff1562d16722ad413d6a9ba/invoke.js";
  container.appendChild(s1);

  // 2) Container div
  const adDiv = document.createElement('div');
  adDiv.id = "container-2095e01c6ff1562d16722ad413d6a9ba";
  container.appendChild(adDiv);
}

/* ----------------- Top slim ad + Native ad injection ----------------- */
document.addEventListener('DOMContentLoaded', ()=>{
  // top slim ad (728x90)
  const topInner = document.getElementById('topSlimAdInner');
  // use the key from original file: b40d9ebf8b9bb68f80451819ab41596e
  injectAtOptionsAd('b40d9ebf8b9bb68f80451819ab41596e', topInner, 728, 90);

  // Inject Native Banner at the bottom of the page (Added)
  const nativeAdContainer = document.getElementById('nativeAd');
  injectNativeBannerAd(nativeAdContainer);

  // initial render of suggestions
  renderVideoSuggestions(ALL_VIDEOS);

  // push initial state to history so back button works to original page
  try{
    const stateObj = { video_id: VIDEO_ID, title: INITIAL_DATA.title, video_url: player.querySelector('source').src, time_ago: 'just now', likes: likesEl.innerText || 0, views: viewsEl.innerText || 0, thumb: INITIAL_DATA.thumb };
    history.replaceState(stateObj, INITIAL_DATA.title, location.pathname);
  }catch(e){}
});

/* ----------------- Render suggestions with ad logic ----------------- */
function renderVideoSuggestions(videos){
  videoSuggestionsList.innerHTML = '';
  let suggestion_count = 0;

  for (let i=0;i<videos.length;i++){
    const v = videos[i];
    if (!v || v.video_id === VIDEO_ID) continue; // hide current video
    // Insert ad after every 2 shown suggestions
    if (suggestion_count > 0 && suggestion_count % 2 === 0){
      const adDiv = document.createElement('div');
      adDiv.className = 'suggested-ad-slot';
      // container for ad script
      const inner = document.createElement('div');
      // responsive wrapper
      inner.style.width = '300px';
      inner.style.height = '250px';
      inner.style.maxWidth = '95%';
      adDiv.appendChild(inner);
      videoSuggestionsList.appendChild(adDiv);
      // inject ad (300x250)
      // use the key from original file: e8550078b37b6bf29c9b54eed61806f7
      injectAtOptionsAd('e8550078b37b6bf29c9b54eed61806f7', inner, 300, 250);
    }

    // Suggestion item
    const item = document.createElement('div');
    item.className = 'suggestion-item';
    item.setAttribute('data-video-id', v.video_id);

    item.innerHTML = `
      <div class="suggestion-thumbnail">
        <img src="${v.thumb_url}" alt="${escapeHtml(v.title)} thumbnail" loading="lazy">
      </div>
      <div class="suggestion-details">
        <div class="suggestion-title">${escapeHtml(v.title)}</div>
        <div class="suggestion-creator">${escapeHtml(v.creator || '')}</div>
      </div>
    `;

    item.addEventListener('click', (e)=>{
      e.preventDefault();
      // play and update
      playSuggestedVideo(v);
    });

    videoSuggestionsList.appendChild(item);
    suggestion_count++;
  }
}

/* ----------------- Play suggested video in-place ----------------- */
function playSuggestedVideo(videoData){
  if(!videoData || !videoData.video_url) return;

  // 1) update player source
  const sourceEl = player.querySelector('source');
  sourceEl.src = videoData.video_url;
  player.load();
  player.play().catch(()=>{/* autoplay may be blocked on some platforms */});

  // reset view counter
  viewCounted = false;

  // 2) update visible metadata: title, time, likes, views, creator
  timeAgoEl.innerText = videoData.time_ago || '';
  mainTitleEl.innerText = videoData.title || '';
  creatorNameEl.innerText = videoData.creator || '';
  likesEl.innerText = (typeof videoData.likes !== 'undefined') ? videoData.likes : (likesEl.innerText || '0');
  viewsEl.innerText = (typeof videoData.views !== 'undefined') ? videoData.views : (viewsEl.innerText || '0');

  // 3) update social/meta tags so share & crawler see new data
  safeUpdateMetaTags({
    title: videoData.title || document.title,
    description: videoData.description || '',
    image: videoData.thumb_url || videoData.thumb || INITIAL_DATA.thumb,
    player_page: videoData.player_page_url || `/v/${videoData.video_id}.html`,
    stream: videoData.video_url || ''
  });

  // 4) update document title
  document.title = (videoData.title ? (videoData.title + ' | Clipfy Player') : 'Clipfy Player');

  // 5) update global VIDEO_ID and pushState
  const prevPath = location.pathname;
  const newPath = `/v/${videoData.video_id}.html`;
  VIDEO_ID = videoData.video_id;
  const stateObj = Object.assign({}, videoData);
  try{
    if (prevPath !== newPath) history.pushState(stateObj, videoData.title, newPath);
    else history.replaceState(stateObj, videoData.title, newPath);
  }catch(e){}

  // 6) re-render suggestions (to hide current)
  renderVideoSuggestions(ALL_VIDEOS);

  // 7) scroll to top for UX
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

/* ----------------- Back / forward handling ----------------- */
window.onpopstate = function(event){
  if (event.state && event.state.video_id){
    // Play the state.video_id without pushing a new history entry
    const s = event.state;
    // If the state includes the video_url, use it; otherwise find in ALL_VIDEOS
    const vidData = (s.video_url ? s : (ALL_VIDEOS.find(x=>x.video_id===s.video_id) || s));
    // Set source and update UI, but do NOT push state (we're responding to popstate)
    const sourceEl = player.querySelector('source');
    if (vidData.video_url) sourceEl.src = vidData.video_url;
    player.load();
    player.play().catch(()=>{});
    viewCounted = false;
    // update UI fields
    timeAgoEl.innerText = vidData.time_ago || '';
    mainTitleEl.innerText = vidData.title || '';
    creatorNameEl.innerText = vidData.creator || '';
    likesEl.innerText = vidData.likes || likesEl.innerText || '0';
    viewsEl.innerText = vidData.views || viewsEl.innerText || '0';
    // update meta tags too
    safeUpdateMetaTags({
      title: vidData.title || document.title,
      description: vidData.description || '',
      image: vidData.thumb_url || vidData.thumb || INITIAL_DATA.thumb,
      player_page: vidData.player_page_url || `/v/${vidData.video_id}.html`,
      stream: vidData.video_url || ''
    });
    VIDEO_ID = vidData.video_id;
    renderVideoSuggestions(ALL_VIDEOS);
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }
};

/* ----------------- Meta tag updater (safe) ----------------- */
function safeUpdateMetaTags({title, description, image, player_page, stream}){
  // Update meta tags that matter for Twitter/OpenGraph and internal sharing
  try{
    setOrCreateMeta('twitter:title', title);
    setOrCreateMeta('twitter:description', description);
    setOrCreateMeta('twitter:image', image);
    setOrCreateMeta('og:image', image);
    setOrCreateMeta('twitter:player', player_page);
    setOrCreateMeta('twitter:player:stream', stream);
    // Update document title too (already set earlier, but keep safe)
    document.title = title + ' | Clipfy Player';
  }catch(e){}
}

function setOrCreateMeta(nameOrProp, value){
  if(!value) return;
  let sel;
  if (nameOrProp.startsWith('og:')) sel = `meta[property="${nameOrProp}"]`; // Corrected: Check for og: property
  else sel = `meta[name="${nameOrProp}"]`;
  let el = document.querySelector(sel);
  if (!el){
    el = document.createElement('meta');
    if (nameOrProp.startsWith('og:')) el.setAttribute('property', nameOrProp);
    else el.setAttribute('name', nameOrProp);
    document.head.appendChild(el);
  }
  el.setAttribute('content', value);
}

/* ----------------- helper: escape html for title text (very small) ----------------- */
function escapeHtml(str){
  if (!str) return '';
  return String(str).replace(/[&<>"']/g, function(m){ return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]; });
}

/* ----------------------------------------------------------------- */
</script>
</body>
</html>
