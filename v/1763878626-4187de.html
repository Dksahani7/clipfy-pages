<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Clipfy Player</title>

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="{{TITLE}}" />
<meta name="twitter:description" content="{{DESCRIPTION}}" />
<meta name="twitter:image" content="https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/2de0ed9e662547fc855ee4b169b6bfac.jpg" />
<meta property="og:image" content="https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/2de0ed9e662547fc855ee4b169b6bfac.jpg" />
<meta property="og:image:width" content="1280" />
<meta property="og:image:height" content="720" />
<meta name="twitter:player" content="{{PLAYER_PAGE_URL}}" />
<meta name="twitter:player:width" content="720" />
<meta name="twitter:player:height" content="405" />
<meta name="twitter:player:stream" content="https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/videos/0fcd051484784b299bcfde83dae9a5a7.mp4" />
<meta name="twitter:player:stream:content_type" content="video/mp4" />

  
<style>
body {
  background:#0f141a;
  color:white;
  font-family:Arial, sans-serif;
  padding:0;
  margin:0;
}

/* ========================================= */
/* 1. FIXED VIDEO BOX (MODIFIED) */
/* ========================================= */
.video-box {
  width:100%;
  height:40vh; /* Changed: Fixed video area to 40% of viewport height */
  padding:0;
  /* Added: Make it fixed at the top */
  position: fixed;
  top: 0;
  left: 0;
  z-index: 10; /* Ensure video is above scrollable content */
  overflow:hidden;
}

video {
  width:100%;
  height:100%;
  /* Use 'contain' to ensure reels/vertical video is not cropped, 
     or 'cover' if you want it to fill 40vh area, potentially cropping edges. 
     Keeping 'cover' as per original code's aesthetic. */
  object-fit:cover; 
  border-radius:0; /* full bleed */
}

/* ========================================= */
/* 2. SCROLLABLE CONTENT WRAPPER (NEW) */
/* ========================================= */
.content-wrapper {
    /* Added: Push content below the 40vh fixed video box */
    margin-top: 40vh;
}

/* --- Original Styles (Inside content-wrapper) --- */
.header {
  display:flex;
  justify-content:space-between;
  padding:12px;
  border-bottom:1px solid #222;
  font-size:20px;
}

.post {
  padding:12px;
  display:flex;
  gap:10px;
  align-items:center;
}

.post .dp {
  width:42px;
  height:42px;
  border-radius:50%;
  background:#555;
}

.title {
  margin-top:4px;
  font-size:14px;
  color:#aaa;
}

.stats {
  display:flex;
  gap:12px;
  padding:12px;
  font-size:14px;
  align-items:center;
  border-bottom:1px solid #222; /* Added separator for clarity */
}

.stat-btn { cursor:pointer; user-select:none; }

.cta { display:none }

/* Optional: Ad/Blog Content area (Below Stats) */
.blog-content {
    padding: 12px;
    line-height: 1.6;
    font-size: 16px;
}

.ad-slot {
    text-align: center;
    background: #1a2430;
    padding: 20px;
    margin: 20px 12px;
    border-radius: 8px;
    font-size: 14px;
    color: #888;
}
</style>
</head>

<body>

<div class="video-box"> 
  <div style="position:absolute; z-index:10; margin:10px; background:rgba(0,0,0,0.55); padding:6px 10px; border-radius:6px; font-size:13px; display:flex; align-items:center; gap:4px;">
    <span style="font-weight:700;">тЦ╢ X Video</span>
  </div>
  <video id="player" playsinline controls autoplay muted>
    <source src="https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/videos/0fcd051484784b299bcfde83dae9a5a7.mp4" type="video/mp4">
    </video>
</div>

<div class="content-wrapper">
  
  <div class="header">
    <div>X</div>
    <div>тЛп</div>
  </div>

  <div class="post">
    <div class="dp"></div>
    <div>
      <div style="font-weight:700;">Content Creator Name</div>
      <div class="title" id="timeAgo">Loading...</div>
    </div>
  </div>

  <div class="stats">
    <div id="likeBtn" class="stat-btn">тЭдя╕П <span id="likes">0</span></div>
    <div>ЁЯСБя╕П <span id="views">0</span></div>
    <div style="margin-left:auto; font-size:14px; cursor:pointer;" id="shareBtn">ЁЯФЧ Share</div>
  </div>

  <div class="blog-content">
      <p style="font-weight:700; color:#eee;">рдпрд╣ рд╣реИ рдмреНрд▓реЙрдЧ/рд╕реНрдЯреЛрд░реА рдХреА рдореБрдЦреНрдп рдЬрд╛рдирдХрд╛рд░реА:</p>
      
      <p>рд╡реАрдбрд┐рдпреЛ рдКрдкрд░ 40% рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдлрд┐рдХреНрд╕ рд╣реИ, рдЬрдмрдХрд┐ рдЖрдк рдиреАрдЪреЗ рдпрд╣ рд▓реЗрдЦ рд╕реНрдХреНрд░реЙрд▓ рдХрд░рдХреЗ рдкрдврд╝ рд░рд╣реЗ рд╣реИрдВред рдпрд╣ рдПрдХ рдмреЗрд╣рддрд░реАрди рддрд░реАрдХрд╛ рд╣реИ рдЬрд┐рд╕рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╡реАрдбрд┐рдпреЛ рджреЗрдЦрддреЗ рд╣реБрдП рдХрдВрдЯреЗрдВрдЯ рд╕реЗ рдЬреБрдбрд╝реЗ рд░рд╣ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рдбрд┐рдЬрд╝рд╛рдЗрди рдЦрд╛рд╕рдХрд░ рдореЛрдмрд╛рдЗрд▓ рдФрд░ рд╕реЛрд╢рд▓ рдореАрдбрд┐рдпрд╛ рдПрдореНрдмреЗрдбреЗрдб рдкреНрд▓реЗрдпрд░ (Twitter/X) рдХреЗ рд▓рд┐рдП рдЕрдиреБрдХреВрд▓рд┐рдд рд╣реИред</p>
      
      <div class="ad-slot">
          <strong>рд╡рд┐рдЬреНрдЮрд╛рдкрди рдХреНрд╖реЗрддреНрд░ 1:</strong> (300x250 Ad Code рдпрд╣рд╛рдБ рдкреЗрд╕реНрдЯ рдХрд░реЗрдВ)
      </div>

      <p>рд╣рдордиреЗ рдпрд╣рд╛рдБ рдХреБрдЫ рдЕрддрд┐рд░рд┐рдХреНрдд рдЯреЗрдХреНрд╕реНрдЯ рдЬреЛрдбрд╝рд╛ рд╣реИ рддрд╛рдХрд┐ рдкреЗрдЬ рдореЗрдВ рдкрд░реНрдпрд╛рдкреНрдд рд╕реНрдХреНрд░реЙрд▓рд┐рдВрдЧ рд╕реНрдкреЗрд╕ рдмрди рд╕рдХреЗред рдлрд┐рдХреНрд╕ рд╡реАрдбрд┐рдпреЛ рд╣реЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп, `margin-top` CSS рдкреНрд░реЙрдкрд░реНрдЯреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдиреАрдЪреЗ рдХрд╛ рдХрдВрдЯреЗрдВрдЯ рдлрд┐рдХреНрд╕ рдмрд╛рд░ рдХреЗ рдиреАрдЪреЗ рд╕реЗ рд╢реБрд░реВ рд╣реЛред</p>
      
      <p>рдпрд╣ рд▓реЗрдЖрдЙрдЯ рдЖрдкрдХреА рд╕рднреА рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ (40% рдлрд┐рдХреНрд╕ рд╡реАрдбрд┐рдпреЛ, рдиреАрдЪреЗ рд╕реНрдХреНрд░реЙрд▓ рд╣реЛрдиреЗ рд╡рд╛рд▓рд╛ рдХрдВрдЯреЗрдВрдЯ рдФрд░ рд╡рд┐рдЬреНрдЮрд╛рдкрди) рдХреЛ рдкреВрд░рд╛ рдХрд░рддрд╛ рд╣реИред рдЖрдкрдХреЛ рдмрд╕ рдЕрдкрдиреА рд╡реАрдбрд┐рдпреЛ URL рдФрд░ API рдПрдВрдбрдкреЙрдЗрдВрдЯ рдХреЛ рд░рд┐рдкреНрд▓реЗрд╕ рдХрд░рдирд╛ рд╣реИред</p>
      
      <div class="ad-slot">
          <strong>рд╡рд┐рдЬреНрдЮрд╛рдкрди рдХреНрд╖реЗрддреНрд░ 2:</strong> (728x90 Banner Ad Code рдпрд╣рд╛рдБ рдкреЗрд╕реНрдЯ рдХрд░реЗрдВ)
      </div>

      <p>рдзрдиреНрдпрд╡рд╛рдж, рдЖрдкрдХрд╛ рдкреЗрдЬ рдЕрдм **Ready to Use** рд╣реИ!</p>
  </div>

</div>


<script>
const VIDEO_ID = '{{VIDEO_ID}}';
const API_BASE = '{{API_BASE}}'; // e.g. https://your-workers-domain.workers.dev

const likesEl = document.getElementById('likes');
const viewsEl = document.getElementById('views');
const likeBtn = document.getElementById('likeBtn');
const shareBtn = document.getElementById('shareBtn');
// Removed 'fakePlay' as it's not in the modified HTML
const player = document.getElementById('player'); // Corrected variable name

let liked = false;

async function fetchStats(){
  try{
    const res = await fetch(`${API_BASE}/stats?video_id=${encodeURIComponent(VIDEO_ID)}`);
    if(!res.ok) return;
    const j = await res.json();
    likesEl.textContent = j.likes || 0;
    viewsEl.textContent = j.views || 0;
  }catch(e){console.log('stat fetch err',e)}
}

// Increment view once when user first interacts or autoplay plays
let viewCounted = false;
function countViewOnce(){
  if(viewCounted) return; viewCounted = true;
  fetch(`${API_BASE}/hit`, {method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({video_id:VIDEO_ID, type:'view'})}).catch(()=>{});
}

// Try to count view after play event or after short timeout
// Since fakePlay is removed, using timeout and play event listeners directly
player.addEventListener('play', ()=>countViewOnce());
setTimeout(()=>{ if(!viewCounted) countViewOnce(); }, 3500);

// Like button
likeBtn.addEventListener('click', async ()=>{
  liked = !liked;
  likeBtn.style.opacity = liked ? '0.7' : '1';
  try{
    const res = await fetch(`${API_BASE}/like`, {method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({video_id:VIDEO_ID, like: liked})});
    if(res.ok){ const j = await res.json(); likesEl.textContent = j.likes; }
  }catch(e){console.log('like err',e)}
});

// Share
shareBtn.addEventListener('click', ()=>{
  if(navigator.share){ navigator.share({title:'Clipfy', url:location.href}).catch(()=>{}); }
  else{ navigator.clipboard.writeText(location.href).then(()=>alert('Link copied')) }
});

// Initial load
fetchStats();

// Optional: poll for updates every 15s to give realtime feel
setInterval(fetchStats,15000);

// Time Ago
const createdAt = '{{CREATED_AT}}'; // bot will inject e.g. 2025-11-20T05:00:00Z
function timeAgo(ts){
  const diff = (Date.now() - new Date(ts).getTime())/1000;
  if(diff < 60) return Math.floor(diff)+"s ago";
  if(diff < 3600) return Math.floor(diff/60)+"m ago";
  if(diff < 86400) return Math.floor(diff/3600)+"h ago";
  return Math.floor(diff/86400)+"d ago";
}
if(createdAt && createdAt !== '{{CREATED_AT}}'){
  document.getElementById('timeAgo').textContent = 'Trending ┬╖ ' + timeAgo(createdAt);
}
</script>

</html>
