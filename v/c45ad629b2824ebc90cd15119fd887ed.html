<!doctype html>
<html>
<head>
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
  <title>Ig%20 %20Dankgc69 | Clipfy Player</title>

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Ig%20 %20Dankgc69">
  <meta name="twitter:description" content="">
  <meta name="twitter:image" content="https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/c45ad629b2824ebc90cd15119fd887ed.jpg">

  <meta property="og:image" content="https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/thumbs/c45ad629b2824ebc90cd15119fd887ed.jpg">
  <meta property="og:image:width" content="1280">
  <meta property="og:image:height" content="720">

  <meta name="twitter:player" content="https://clipfy.store/v/c45ad629b2824ebc90cd15119fd887ed.html">
  <meta name="twitter:player:width" content="720">
  <meta name="twitter:player:height" content="405">
  <meta name="twitter:player:stream" content="https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/Video%20for%20link/IG%20-%20DANKGC69.mp4">
  <meta name="twitter:player:stream:content_type" content="video/mp4">

  <style>
    body{
      background:#0f141a;
      color:#fff;
      font-family:Arial, sans-serif;
      margin:0;
      padding:0;
      overflow-x:hidden;
    }

    .video-box{
      width:100%;
      height:40vh;
      position:fixed;
      top:0;
      left:0;
      background:#000;
      overflow:hidden;
      z-index:9999;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .video-box video{
      width:100%;
      height:100%;
      object-fit:contain;
    }

    .floating-ad-320x50{
      position:fixed;
      top:4px;
      left:50%;
      transform:translateX(-50%);
      z-index:10000;
      width:320px;
      max-width:95%;
      height:50px;
      pointer-events:auto;
    }

    .content-wrapper{
      padding-top:40vh;
      min-height:200vh;
    }

    .top-thin-ad{
      background:#1a2430;
      padding:6px 0;
      margin:0;
      text-align:center;
      border-bottom:1px solid #222;
    }
    .top-thin-ad-inner{
      width:728px;
      max-width:95%;
      height:90px;
      margin:0 auto;
    }

    .post{
      padding:10px 16px;
      display:flex;
      gap:10px;
      align-items:center;
      border-bottom:1px solid #222;
    }
    .dp{
      width:42px;
      height:42px;
      border-radius:50%;
      background:#555;
    }
    #creatorName{
      font-weight:600;
      font-size:15px;
    }
    #timeAgo{
      font-size:12px;
      color:#aaa;
      margin-top:2px;
    }

    .stats{
      display:flex;
      gap:14px;
      padding:8px 16px;
      border-bottom:1px solid #222;
      font-size:13px;
      align-items:center;
    }
    .stat-item{
      display:flex;
      align-items:center;
      gap:4px;
      color:#d0d0d0;
    }
    .stat-icon{
      width:14px;
      height:14px;
      stroke:#d0d0d0;
      fill:none;
    }
    .stats-right{
      margin-left:auto;
      cursor:pointer;
      font-size:13px;
    }

    .blog-content{
      padding:14px 16px;
      font-size:15px;
      line-height:1.5;
    }
    #mainTitle{
      margin:0 0 6px 0;
      font-size:18px;
      font-weight:600;
    }

    .suggestions-header{
      padding:10px 16px;
      font-size:16px;
      font-weight:700;
      border-top:1px solid #222;
    }
    .video-suggestions-list{
      background:transparent;
    }
    .suggestion-item{
      display:block;
      width:100%;
      padding:10px 16px 14px;
      cursor:pointer;
      border-bottom:1px solid #1a2430;
      transition:background .12s;
    }
    .suggestion-item:hover{
      background:#0b1216;
    }
    .suggestion-thumbnail{
      width:100%;
      aspect-ratio:16/9;
      background:#333;
      border-radius:6px;
      overflow:hidden;
      margin-bottom:8px;
    }
    .suggestion-thumbnail img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }
    .suggestion-details{
      display:flex;
      flex-direction:column;
      justify-content:center;
    }
    .suggestion-title{
      font-weight:600;
      font-size:15px;
      display:-webkit-box;
      -webkit-line-clamp:2;
      -webkit-box-orient:vertical;
      overflow:hidden;
    }
    .suggestion-creator{
      font-size:12px;
      color:#aaa;
      margin-top:3px;
    }

    .suggested-ad-slot{
      display:flex;
      justify-content:center;
      padding:12px 0;
      border-bottom:1px solid #222;
      background:transparent;
      min-height:250px;
    }

    .footer-ad-320x50{
      position:fixed;
      bottom:0;
      left:0;
      width:100%;
      z-index:10001;
      background:#000;
      display:flex;
      justify-content:center;
      padding:4px 0;
    }
    .footer-ad-inner{
      width:320px;
      max-width:95%;
      height:50px;
    }

    /* Social bar (sandboxed iframe) - hidden initially */
    #socialBarContainer{
      position:fixed;
      top:6vh; /* appear over video a bit below top */
      left:50%;
      transform:translateX(-50%);
      z-index:10002;
      width:320px;
      max-width:95%;
      height:56px;
      display:none; /* will show after delay */
      align-items:center;
      justify-content:center;
      pointer-events:auto;
    }
    #socialBarFrame{
      width:100%;
      height:100%;
      border:0;
      border-radius:6px;
      overflow:hidden;
      background:#000;
    }

    .hidden{display:none!important;}
  </style>
</head>
<body>

  <div class="floating-ad-320x50" id="floatingAd320x50"></div>

  <div class="video-box">
    <video id="player" playsinline controls autoplay muted>
      <source src="https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/Video%20for%20link/IG%20-%20DANKGC69.mp4" type="video/mp4">
    </video>
  </div>

  <div class="content-wrapper">

    <div class="top-thin-ad">
      <div class="top-thin-ad-inner" id="topThinAdInner"></div>
    </div>

    <div class="post">
      <div class="dp" id="creatorDp"></div>
      <div>
        <div id="creatorName">Clipfy Videos</div>
        <div id="timeAgo">just now</div>
      </div>
    </div>

    <div class="stats">
      <div class="stat-item">
        <svg class="stat-icon" viewBox="0 0 24 24">
          <path d="M2 12s3.5-6 10-6 10 6 10 6-3.5 6-10 6-10-6-10-6z"/>
          <circle cx="12" cy="12" r="3"/>
        </svg>
        <span id="views">18685</span>
      </div>

      <div class="stat-item">
        <svg class="stat-icon" viewBox="0 0 24 24">
          <path d="M12 21s-5-3.3-8-6.7C2 12.5 2 9.5 4 7.5 5.1 6.4 6.6 6 8 6c1.6 0 3.1.8 4 2 0.9-1.2 2.4-2 4-2 1.4 0 2.9.4 4 1.5 2 2 2 5 0 6.8C17 17.7 12 21 12 21z"/>
        </svg>
        <span id="likes">636</span>
      </div>

      <div class="stats-right" id="shareBtn">Share</div>
    </div>

    <div class="blog-content">
      <h2 id="mainTitle">Ig%20 %20Dankgc69</h2>
    </div>

    <div class="suggestions-header">More Viral Videos ðŸ”¥</div>
    <div class="video-suggestions-list" id="videoSuggestionsList"></div>
  </div>

  <div id="socialBarContainer" aria-hidden="true">
    <!-- social ad will be loaded into this sandboxed iframe so global page clicks don't trigger redirects.
         iframe only allows scripts inside to run; clicks outside iframe won't affect ad. -->
    <iframe id="socialBarFrame" sandbox="allow-scripts allow-same-origin"></iframe>
  </div>

  <div class="footer-ad-320x50">
    <div class="footer-ad-inner" id="footerAdInner"></div>
  </div>

<script>
/* ------------------------
   CONFIG (from your input)
   ------------------------ */
const TOP_BANNER = {
  key: 'b40d9ebf8b9bb68f80451819ab41596e',
  src: '//stinkymildred.com/b40d9ebf8b9bb68f80451819ab41596e/invoke.js',
  width: 728, height: 90
};
const FOOTER_BANNER = {
  key: 'b43458b980a14fc9fc68555f58ae039f',
  src: '//stinkymildred.com/b43458b980a14fc9fc68555f58ae039f/invoke.js',
  width: 320, height: 50
};
const FLOATING_BANNER = { ...FOOTER_BANNER }; // same key+src
const SUGGESTED_AD = {
  key: 'e8550078b37b6bf29c9b54eed61806f7',
  containerIdPrefix: 'atContainer-e8550078b37b6bf29c9b54eed61806f7',
  src: '//stinkymildred.com/e8550078b37b6bf29c9b54eed61806f7/invoke.js'
};
const POPUNDER_SRC = '//stinkymildred.com/ca/e0/e6/cae0e6616497151a47e216bf81ebf050.js';
const SOCIALBAR_SRC = '//stinkymildred.com/15/a6/05/15a60534651f783c4ee900a1a7101385.js';

/* ------------------------
   UTILS: delay, retry, createScriptWithRetry
   ------------------------ */
function delay(ms){ return new Promise(r=>setTimeout(r,ms)); }

async function createScriptWithRetry({src, inlineText, container, maxAttempts=3, baseDelay=800}){
  // attempts to insert script into container (or head). uses onerror to retry.
  container = container || document.head;
  let attempt = 0;
  while(attempt < maxAttempts){
    attempt++;
    try{
      // cleanup any previous script with same marker
      const marker = 'data-ad-src-'+hashSrc(src||inlineText||Math.random());
      if(container.querySelector && container.querySelector('script['+marker+']')) return;
      const s = document.createElement('script');
      if(inlineText){
        s.type = 'text/javascript';
        s.text = inlineText;
      } else {
        s.type = 'text/javascript';
        s.async = true;
        s.src = src;
      }
      // mark script so duplicates avoided
      try{s.setAttribute(marker,'1');}catch(e){}
      return new Promise((resolve, reject) => {
        let done=false;
        s.onload = ()=>{ if(done) return; done=true; resolve(s); };
        s.onerror = ()=>{ if(done) return; done=true; reject(new Error('script load error')); };
        container.appendChild(s);
        // safety: resolve if no onload after certain time (some ad scripts don't fire onload)
        setTimeout(()=>{ if(done) return; done=true; resolve(s); }, 4000);
      });
    }catch(e){
      // exponential backoff
      const wait = baseDelay * Math.pow(1.8, attempt-1);
      await delay(wait);
      continue;
    }
  }
}

// tiny hash for attribute names
function hashSrc(s){
  let h=0;
  for(let i=0;i<s.length;i++) h = ((h<<5)-h) + s.charCodeAt(i), h |= 0;
  return Math.abs(h).toString(36);
}

/* ------------------------
   injectBannerAd: unified API for all ad slots
   - supports delay, retries
   - avoids duplicate injection using a marker attribute
   ------------------------ */
async function injectBannerAd({key, width, height, src, container, delayMs=0, maxAttempts=3, asyncMode=false, containerHtmlId}){
  if(!container) return;
  const marker = 'data-ad-key-'+key+'-'+width+'x'+height;
  if(container.getAttribute(marker)) return;
  container.setAttribute(marker,'1');

  // optional initial delay (stagger)
  if(delayMs && delayMs>0) await delay(delayMs);

  // For Adsterra style, we create inline atOptions then load the invoke script
  const atOptions = `
    atOptions = {
     'key' : '${key}',
     'format' : '${asyncMode ? 'js' : 'iframe'}',
     'height' : ${height},
     'width' : ${width},
     'params' : {}
    };
  `;

  // If suggestions ad uses async atAsyncOptions pattern, push to atAsyncOptions
  if(asyncMode && window){
    try{
      if(typeof window.atAsyncOptions !== 'object') window.atAsyncOptions = [];
      window.atAsyncOptions.push({
        key: key,
        format: 'js',
        async: true,
        container: containerHtmlId || container.id || '',
        params: {}
      });
    }catch(e){}
  }

  // Insert wrapper to keep DOM clean
  try{
    const wrapper = document.createElement('div');
    wrapper.style.width = '100%';
    wrapper.style.height = '100%';
    wrapper.style.display = 'flex';
    wrapper.style.alignItems = 'center';
    wrapper.style.justifyContent = 'center';
    container.innerHTML = '';
    container.appendChild(wrapper);

    // add inline config script to wrapper then load invoke script with retry
    const configScriptText = atOptions;
    await createScriptWithRetry({ inlineText: configScriptText, container: wrapper, maxAttempts: maxAttempts });
    await createScriptWithRetry({ src: src, container: wrapper, maxAttempts: maxAttempts });
  }catch(e){
    // final fallback: leave container empty (or optionally place a placeholder)
    // console.error('ad injection failed',e);
  }
}

/* ------------------------
   PAGE: fetch metadata list and render suggestions
   - Suggestion ads appear every 2 items
   - Ads are lazy-injected only when ad container is near viewport (IntersectionObserver)
   - Staggered small delay for each ad to reduce simultaneous loads
   ------------------------ */
let VIDEOID='c45ad629b2824ebc90cd15119fd887ed';
const APIBASE='https://clipfy.store/api/';

let ALLVIDEOS=[];
fetch('https://pub-a3ad4cec48664940879fc5dd37a07293.r2.dev/metadata/index.json')
.then(r=>r.json())
.then(d=>{
  ALLVIDEOS = d.sort(()=>Math.random()-0.5);
  renderVideoSuggestions(ALLVIDEOS);
})
.catch(e=>{ /* ignore fetch fail */ });

const player=document.getElementById('player');
const likesEl=document.getElementById('likes');
const viewsEl=document.getElementById('views');
const timeAgoEl=document.getElementById('timeAgo');
const mainTitleEl=document.getElementById('mainTitle');
const creatorNameEl=document.getElementById('creatorName');
const videoSuggestionsList=document.getElementById('videoSuggestionsList');
const shareBtn=document.getElementById('shareBtn');
const topThinAdInner=document.getElementById('topThinAdInner');
const footerAdInner=document.getElementById('footerAdInner');
const floatingAd320=document.getElementById('floatingAd320x50');
const socialBarContainer=document.getElementById('socialBarContainer');
const socialBarFrame=document.getElementById('socialBarFrame');

let viewCounted=false;
player.addEventListener('play',()=>{
 if(viewCounted) return;
 viewCounted=true;
 fetch(APIBASE+'hit',{
   method:'POST',
   headers:{'Content-Type':'application/json'},
   body:JSON.stringify({videoid:VIDEOID,type:'view'})
 }).catch(()=>{});
});

// share button
shareBtn.onclick=()=>{
 const mt=document.querySelector('meta[name="twitter:title"]');
 const shareTitle=(mt && mt.getAttribute('content')) || document.title;
 if(navigator.share){
   navigator.share({title:shareTitle,url:location.href}).catch(()=>{});
 } else {
   navigator.clipboard?.writeText(location.href)
     .then(()=>alert('Link Copied!'))
     .catch(()=>alert(location.href));
 }
};

/* ------------------------
   Render suggestions with ad slots
   ------------------------ */
function renderVideoSuggestions(videos){
 videoSuggestionsList.innerHTML='';
 let shown=0;
 let adIndex = 0;
 for(const v of videos){
   if(!v||v.videoid===VIDEOID) continue;
   if(v.videoid && v.videoid.includes('_safe')) continue;

   // every 2 items place an ad slot BEFORE the item (as you requested)
   if(shown>0 && shown%2===0){
     adIndex++;
     const adSlot=document.createElement('div');
     adSlot.className='suggested-ad-slot';
     // unique container id per ad
     const containerId = SUGGESTED_AD.containerIdPrefix + (adIndex);
     const inner=document.createElement('div');
     inner.id = containerId;
     inner.style.width='300px';
     inner.style.height='250px';
     inner.style.maxWidth='95%';
     adSlot.appendChild(inner);
     videoSuggestionsList.appendChild(adSlot);

     // Lazy inject using IntersectionObserver and stagger
     observeAndInjectAd(inner, adIndex);
   }

   const item=document.createElement('div');
   item.className='suggestion-item';
   item.dataset.videoId=v.videoid;
   item.innerHTML=`
     <div class="suggestion-thumbnail">
       <img src="${escapeHtml(v.thumburl)}" loading="lazy">
     </div>
     <div class="suggestion-details">
       <div class="suggestion-title">${escapeHtml(v.title)}</div>
       <div class="suggestion-creator">${escapeHtml(v.creator)}</div>
     </div>
   `;
   item.onclick=e=>{
     e.preventDefault();
     playSuggestedVideo(v);
   };
   videoSuggestionsList.appendChild(item);
   shown++;
 }
}

// observe when ad container becomes visible and then inject ad with small staggered delay
function observeAndInjectAd(container, idx){
  const io = new IntersectionObserver((entries, obs)=>{
    for(const en of entries){
      if(en.isIntersecting){
        // small stagger: base 300ms * idx
        const staggerDelay = 300 * (idx % 3) + Math.floor(Math.random()*300);
        injectBannerAd({
          key: SUGGESTED_AD.key,
          width: 300,
          height: 250,
          src: SUGGESTED_AD.src,
          container: container,
          delayMs: staggerDelay,
          maxAttempts: 4,
          asyncMode: true,
          containerHtmlId: container.id
        });
        obs.unobserve(container);
      }
    }
  }, {threshold: 0.3});
  io.observe(container);
}

/* ------------------------
   playSuggestedVideo: replaces current video WITHOUT reload
   ------------------------ */
function playSuggestedVideo(v){
 if(!v||!v.videourl) return;
 const src = player.querySelector('source');
 if(!src) return;
 src.src = v.videourl;
 player.load();
 player.play().catch(()=>{});
 viewCounted=false;

 VIDEOID = v.videoid;
 mainTitleEl.innerText = v.title || '';
 timeAgoEl.innerText = v.timeago || '';
 creatorNameEl.innerText = v.creator || 'Clipfy Videos';
 likesEl.innerText = v.likes ?? 0;
 viewsEl.innerText = v.views ?? 0;

 safeUpdateMetaTags({
   title: v.title,
   document_title: (v.title||'') + ' | Clipfy Player',
   description: v.description,
   image: v.thumburl,
   playerpage: 'v/'+v.videoid+'.html',
   stream: v.videourl
 });

 history.pushState({...v}, v.title, 'v/'+v.videoid+'.html');
 // scroll to top smoothly
 window.scrollTo({top:0,behavior:'smooth'});
}

/* ------------------------
   handle back/forward
   ------------------------ */
window.onpopstate = ev => {
 if(!ev.state) return;
 const v = ev.state;
 const src = player.querySelector('source');
 src.src = v.videourl;
 player.load();
 player.play();

 VIDEOID = v.videoid;
 mainTitleEl.innerText = v.title || '';
 timeAgoEl.innerText = v.timeago || '';
 creatorNameEl.innerText = v.creator || 'Clipfy Videos';
 likesEl.innerText = v.likes ?? 0;
 viewsEl.innerText = v.views ?? 0;

 safeUpdateMetaTags({
   title: v.title,
   document_title: (v.title||'') + ' | Clipfy Player',
   description: v.description,
   image: v.thumburl,
   playerpage: 'v/'+v.videoid+'.html',
   stream: v.videourl
 });

 window.scrollTo({top:0,behavior:'smooth'});
};

/* ------------------------
   safeUpdateMetaTags helper
   ------------------------ */
function safeUpdateMetaTags(o){
 try{
   setOrCreateMeta('twitter:title',o.title);
   setOrCreateMeta('twitter:image',o.image);
   setOrCreateMeta('twitter:description',o.description);
   setOrCreateMeta('og:image',o.image);
   setOrCreateMeta('twitter:player',o.playerpage);
   setOrCreateMeta('twitter:player:stream',o.stream);
   document.title = o.document_title;
 }catch(e){}
}

function setOrCreateMeta(name,value){
 if(!value) return;
 const isOg = name.startsWith('og');
 const sel = isOg ? `meta[property="${name}"]` : `meta[name="${name}"]`;
 let el = document.querySelector(sel);
 if(!el){
   el = document.createElement('meta');
   if(isOg) el.setAttribute('property', name);
   else el.setAttribute('name', name);
   document.head.appendChild(el);
 }
 el.setAttribute('content', value);
}

function escapeHtml(str){
 return (str||"").replace(/&/g,'&amp;').replace(/</g,'&lt;');
}

/* ------------------------
   INITIAL AD INJECTIONS (top, footer, floating)
   - add small random delays to avoid simultaneous requests
   - use retry
   ------------------------ */
document.addEventListener('DOMContentLoaded',()=>{
  // top banner: 800-1400ms random delay
  const topDelay = 800 + Math.floor(Math.random()*700);
  injectBannerAd({
    key: TOP_BANNER.key,
    width: TOP_BANNER.width,
    height: TOP_BANNER.height,
    src: TOP_BANNER.src,
    container: topThinAdInner,
    delayMs: topDelay,
    maxAttempts: 4,
    asyncMode: false
  });

  // footer banner: 1200-2200ms delay
  const footerDelay = 1200 + Math.floor(Math.random()*1000);
  injectBannerAd({
    key: FOOTER_BANNER.key,
    width: FOOTER_BANNER.width,
    height: FOOTER_BANNER.height,
    src: FOOTER_BANNER.src,
    container: footerAdInner,
    delayMs: footerDelay,
    maxAttempts: 4,
    asyncMode: false
  });

  // floating banner: 2000-3500ms delay
  const floatDelay = 2000 + Math.floor(Math.random()*1500);
  injectBannerAd({
    key: FLOATING_BANNER.key,
    width: FLOATING_BANNER.width,
    height: FLOATING_BANNER.height,
    src: FLOATING_BANNER.src,
    container: floatingAd320,
    delayMs: floatDelay,
    maxAttempts: 4,
    asyncMode: false
  });

  // schedule popunder loader with safe cooldown (we still inject script after small delay)
  setTimeout(()=>{ try{initPopunder();}catch(e){} }, 15000 + Math.floor(Math.random()*5000));
});

/* ------------------------
   POPUNDER logic (12 hours cooldown preserved)
   ------------------------ */
function initPopunder(){
  const POP_KEY = 'clipfy_pop_ts';
  const now = Date.now();
  const limit = 12*60*60*1000; // 12 hours
  const last = parseInt(localStorage.getItem(POP_KEY) || '0', 10);
  if(last && (now - last) < limit) return;
  try{
    localStorage.setItem(POP_KEY, now);
    // inject popunder script into body
    createScriptWithRetry({ src: POPUNDER_SRC, container: document.body, maxAttempts: 2 })
      .catch(()=>{});
  }catch(e){}
}

/* ------------------------
   SOCIAL BAR (sandboxed iframe) logic
   - show AFTER player starts playing + small delay
   - loads the social script inside iframe so page-wide click listeners from that script won't affect main page
   - only clicks inside iframe area (i.e. the ad itself) will be actionable by the ad
   ------------------------ */
let socialBarShown = false;
function showSocialBarAfterPlay(){
  if(socialBarShown) return;
  socialBarShown = true;

  // display container after a little delay (e.g., 5000ms after play), you asked video ke uper thoda baad me aaye
  const delayAfterPlay = 5000 + Math.floor(Math.random()*2000);
  setTimeout(async ()=>{
    try{
      socialBarContainer.style.display = 'flex';
      socialBarContainer.setAttribute('aria-hidden','false');

      // prepare iframe content (sandboxed). We load a minimal document that pushes the script into its head.
      const iframeDoc = `
        <!doctype html>
        <html>
        <head>
          <meta name="viewport" content="width=device-width,initial-scale=1">
          <style>html,body{margin:0;padding:0;background:transparent}</style>
          <script>
            // create the script tag inside iframe
            (function(){
              var s = document.createElement('script');
              s.type = 'text/javascript';
              s.src = '${SOCIALBAR_SRC}';
              s.async = true;
              document.head.appendChild(s);
            })();
          <\/script>
        </head>
        <body></body>
        </html>
      `;
      // write into iframe
      socialBarFrame.srcdoc = iframeDoc;
      // no need to handle load; iframe will contain the ad
    }catch(e){}
  }, delayAfterPlay);
}

// show social bar once video plays for first time
player.addEventListener('play', ()=>{
  showSocialBarAfterPlay();
});

// also allow manual show after page load (in case user wants)
setTimeout(()=>{ /* nothing */ }, 1000);

/* ------------------------
   Helper: initial injection for suggested ads that might be in DOM early
   (we already set up observer in renderVideoSuggestions)
   ------------------------ */

/* ------------------------
   Small helper: prevent accidental page-level click redirections
   (This will not interfere with iframe's own click behaviour â€” clicks inside iframe remain normal.)
   ------------------------ */
(function preventPageWideRedirects(){
  // capture click events at document level; do NOT stopPropagation for everything,
  // but guard against third-party scripts that try to open a new window on ANY click by listening and preventing default window.open calls via patched window.open.
  try{
    const origOpen = window.open;
    window.open = function(...args){
      // allow opens that are triggered by explicit clicks inside iframes/ad containers only
      // best-effort heuristic: if the last user interaction target was inside socialBarFrame or an ad container, allow
      try{
        const last = window._clipfy_last_user_event_target || null;
        if(last){
          // allow if target is within known ad containers
          const allowedParents = [document.getElementById('socialBarContainer'), document.getElementById('topThinAdInner'), document.getElementById('footerAdInner'), document.getElementById('floatingAd320x50')];
          for(const p of allowedParents){
            if(!p) continue;
            if(p.contains(last)) return origOpen.apply(window, args);
          }
        }
      }catch(e){}
      // otherwise block
      return null;
    };
    // record last click target
    document.addEventListener('click', function(ev){
      window._clipfy_last_user_event_target = ev.target;
      setTimeout(()=>{ window._clipfy_last_user_event_target = null; }, 200);
    }, true);
  }catch(e){}
})();

/* ------------------------
   END OF SCRIPT
   ------------------------ */
</script>

</body>
</html>
